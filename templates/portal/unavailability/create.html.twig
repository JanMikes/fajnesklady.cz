{% extends 'portal/layout.html.twig' %}

{% block title %}Přidat blokování skladu{% endblock %}

{% block breadcrumb %}
    {% include 'components/breadcrumb.html.twig' with {breadcrumb_items: [
        {label: 'Blokování', url: path('portal_unavailabilities_list')},
        {label: 'Přidat blokování'},
    ]} %}
{% endblock %}

{% block content %}
    <div class="card max-w-2xl">
        <div class="card-header bg-gray-50 px-6 py-4 border-b">
            <h1 class="text-xl font-semibold text-gray-900">Přidat blokování skladu</h1>
            <p class="text-sm text-gray-500 mt-1">Zablokujte sklad na určité období (např. z důvodu údržby, renovace nebo rezervace).</p>
        </div>
        <div class="card-body">
            {{ form_start(form, {'attr': {'class': 'space-y-6'}}) }}
                <div>
                    {{ form_label(form.storageId) }}
                    {{ form_widget(form.storageId) }}
                    {{ form_errors(form.storageId) }}
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        {{ form_label(form.startDate) }}
                        {{ form_widget(form.startDate) }}
                        {{ form_errors(form.startDate) }}
                    </div>
                    <div>
                        {{ form_label(form.endDate) }}
                        {{ form_widget(form.endDate) }}
                        {{ form_errors(form.endDate) }}
                    </div>
                </div>

                <div class="flex items-center gap-3">
                    {{ form_widget(form.indefinite) }}
                    {{ form_label(form.indefinite, null, {'label_attr': {'class': 'cursor-pointer select-none'}}) }}
                </div>

                <div>
                    {{ form_label(form.reason) }}
                    {{ form_widget(form.reason) }}
                    {{ form_errors(form.reason) }}
                </div>

                <div class="flex items-center gap-4 pt-4">
                    <button type="submit" class="btn btn-primary">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        Uložit blokování
                    </button>
                    <a href="{{ path('portal_unavailabilities_list') }}" class="btn btn-ghost">Zrušit</a>
                </div>
            {{ form_end(form) }}
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const indefiniteCheckbox = document.getElementById('{{ form.indefinite.vars.id }}');
            const endDateField = document.getElementById('{{ form.endDate.vars.id }}');

            function toggleEndDate() {
                endDateField.disabled = indefiniteCheckbox.checked;
                if (indefiniteCheckbox.checked) {
                    endDateField.value = '';
                }
            }

            indefiniteCheckbox.addEventListener('change', toggleEndDate);
            toggleEndDate();
        });
    </script>
{% endblock %}
